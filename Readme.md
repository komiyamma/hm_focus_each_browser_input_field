# HmFocusEachBrowserInputField

秀丸エディタでの使用を想定した、WebView2コントロール内の最初の入力フィールドにフォーカスを当てるためのコマンドラインユーティリティです。

## 概要

このツールは、秀丸エディタのマクロから呼び出されることを想定したヘルパーアプリケーションです。秀丸エディタがHTMLプレビューなどの機能で埋め込みのWebView2（Edge）ブラウザを使用する際に、このユーティリティは利用可能な最初のHTMLの`<input>`または`<textarea>`フィールドにプログラムでキーボードフォーカスを設定することができます。

これにより、ユーザーがプレビューペインのフォームフィールドに手動でクリックすることなく、すぐにタイピングを開始できるスムーズなワークフローが実現します。

## 使い方

親となる秀丸エディタのウィンドウハンドルを最初の引数として渡し、コマンドラインから実行可能ファイルを実行します。

```shell
HmFocusEachBrowserInputField.exe <hidemaru_window_handle>
```

-   `<hidemaru_window_handle>`: 秀丸エディタのメインウィンドウハンドルの整数値。

プログラムは成功時に`1`、失敗時に`0`の終了コードを返します。

### 秀丸マクロの例

```c
// 秀丸のメインウィンドウハンドルを取得
#h = hidemaruhandle(0);

// 実行可能ファイルのパス
$exe_path = "C:\\path\\to\\HmFocusEachBrowserInputField.exe";

// コマンドを実行
runex(strf("%s %d", $exe_path, #h), 0, 0);

endmacro;
```

## 動作の仕組み

このアプリケーションは、.NETの**UI Automation**フレームワークを使用して、対象アプリケーションのUI要素を検査します。

1.  提供された秀丸エディタのウィンドウハンドルを受け取ります。
2.  UIツリーを探索し、埋め込まれたWebView2ブラウザコントロール（ウィンドウクラス`HM32EachBrowserCtrl`および`Chrome_WidgetWin_0`で識別）を見つけます。
3.  ブラウザコントロールが見つかると、そのコンテンツ内からフォーカス可能な最初の`Edit`コントロール（HTMLの入力フィールドに対応）を検索します。
4.  フィールドが見つかると、それにキーボードフォーカスを設定します。

## ビルド方法

このプロジェクトはC#のソリューションです。ビルドするには：

1.  Visual Studioで`HmFocusEachBrowserInputField.sln`を開きます。
2.  ビルド構成として`Release`を選択します。
3.  ソリューションをビルドします（F6キーまたはビルド > ソリューションのビルド）。
4.  実行可能ファイルは`HmFocusEachBrowserInputField/bin/Release/`に生成されます。

## ライセンス

このプロジェクトはMITライセンスの下でライセンスされています。詳細は[LICENSE](LICENSE)ファイルをご覧ください。
